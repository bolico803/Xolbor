<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xolbor</title>
  <link rel="icon" type="image/png" href="Xolbor-logo.png.jpg">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --secondary: #8b5cf6;
            --accent: #ec4899;
            --dark: #0f172a;
            --darker: #020617;
            --light: #f8fafc;
            --success: #10b981;
            --warning: #f59e0b;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.5); }
            50% { box-shadow: 0 0 40px rgba(139, 92, 246, 0.8); }
        }

        /* Login/Register Page */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow: hidden;
        }

        .auth-background {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }

        .auth-circle {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            opacity: 0.1;
            animation: float 6s ease-in-out infinite;
        }

        .circle-1 { width: 300px; height: 300px; top: -150px; left: -150px; }
        .circle-2 { width: 200px; height: 200px; bottom: 50px; right: 50px; animation-delay: 2s; }
        .circle-3 { width: 250px; height: 250px; top: 50%; left: 50%; animation-delay: 4s; }

        .auth-box {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 24px;
            padding: 40px;
            width: 100%;
            max-width: 450px;
            position: relative;
            z-index: 1;
            animation: slideIn 0.6s ease-out, glow 3s ease-in-out infinite;
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo-icon {
            font-size: 64px;
            animation: pulse 2s ease-in-out infinite;
        }

        .logo-text {
            font-size: 36px;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 600;
            color: var(--light);
        }

        .form-input {
            width: 100%;
            padding: 14px 18px;
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 12px;
            color: var(--light);
            font-size: 15px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
        }

        .btn-secondary {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            margin-top: 12px;
        }

        .btn-secondary:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #fca5a5;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        /* Main App */
        .app-container {
            display: none;
            min-height: 100vh;
        }

        .navbar {
            background: rgba(15, 23, 42, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(99, 102, 241, 0.2);
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-brand {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            cursor: pointer;
        }

        .nav-menu {
            display: flex;
            gap: 24px;
            align-items: center;
        }

        .nav-item {
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(99, 102, 241, 0.2);
            color: var(--primary);
        }

        .nav-user {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .nav-user:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            border: 2px solid var(--primary);
        }

        .xubor-display {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
            color: var(--dark);
        }

        .content {
            padding: 24px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .page-section {
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .page-section.active {
            display: block;
        }

        /* Home Page */
        .search-bar {
            margin-bottom: 32px;
        }

        .search-input {
            width: 100%;
            max-width: 600px;
            padding: 16px 24px;
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 16px;
            color: var(--light);
            font-size: 16px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }

        .game-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .game-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(99, 102, 241, 0.3);
            border-color: var(--primary);
        }

        .game-thumbnail {
            width: 100%;
            height: 180px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 64px;
        }

        .game-info {
            padding: 16px;
        }

        .game-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .game-stats {
            display: flex;
            gap: 16px;
            font-size: 14px;
            color: #94a3b8;
        }

        /* Profile Page */
        .profile-header {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
            text-align: center;
        }

        .profile-avatar-large {
            width: 150px;
            height: 150px;
            margin: 0 auto 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            border: 4px solid var(--primary);
            animation: pulse 3s ease-in-out infinite;
        }

        .profile-username {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .profile-stats {
            display: flex;
            justify-content: center;
            gap: 32px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 14px;
            color: #94a3b8;
        }

        /* Marketplace */
        .marketplace-header {
            margin-bottom: 32px;
        }

        .xubor-packages {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .package-card {
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid rgba(99, 102, 241, 0.3);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .package-card:hover {
            transform: scale(1.05);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(99, 102, 241, 0.3);
        }

        .package-card.featured {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
            border-color: var(--accent);
        }

        .package-amount {
            font-size: 36px;
            font-weight: bold;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 12px;
        }

        .package-price {
            font-size: 28px;
            font-weight: bold;
            color: var(--light);
            margin-bottom: 16px;
        }

        .skins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .skin-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .skin-card:hover {
            transform: translateY(-4px);
            border-color: var(--primary);
        }

        .skin-preview {
            width: 100%;
            height: 150px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }

        .skin-info {
            padding: 12px;
        }

        .skin-name {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .skin-price {
            color: #fbbf24;
            font-weight: bold;
        }

        /* Friends Page */
        .friends-search {
            margin-bottom: 32px;
        }

        .friends-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .friend-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            transition: all 0.3s ease;
        }

        .friend-card:hover {
            border-color: var(--primary);
            transform: translateX(4px);
        }

        .friend-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
        }

        /* Payment Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            animation: slideIn 0.3s ease-out;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: rgba(15, 23, 42, 0.95);
            border: 1px solid rgba(99, 102, 241, 0.3);
            border-radius: 24px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative; /* AjoutÃ© pour positionner le bouton fermer */
        }

        .modal-header {
            margin-bottom: 24px;
            text-align: center;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .close-modal {
            position: absolute;
            top: 16px;
            right: 16px;
            background: none;
            border: none;
            color: var(--light);
            font-size: 28px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            color: var(--accent);
            transform: rotate(90deg);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 16px;
            }

            .nav-menu {
                flex-wrap: wrap;
                justify-content: center;
            }

            .games-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 16px;
            }

            .xubor-packages {
                grid-template-columns: 1fr;
            }

            .auth-box {
                padding: 24px;
            }
        }

        .section-title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 24px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .btn-buy {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-buy:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }

        .btn-buy:disabled {
            background: #374151;
            cursor: not-allowed;
            transform: none;
        }
    </style>
</head>
<body>
    <!-- Auth Page -->
    <div id="authPage" class="auth-container">
        <div class="auth-background">
            <div class="auth-circle circle-1"></div>
            <div class="auth-circle circle-2"></div>
            <div class="auth-circle circle-3"></div>
        </div>

        <div class="auth-box">
            <div class="logo">
                <div class="logo-icon">ğŸ®</div>
                <div class="logo-text">XOLBOR</div>
            </div>

            <div id="errorMessage" class="error-message" style="display: none;"></div>

            <div id="loginForm">
                <div class="form-group">
                    <label class="form-label">Pseudo</label>
                    <input type="text" id="loginUsername" class="form-input" placeholder="Entre ton pseudo">
                </div>
                <div class="form-group">
                    <label class="form-label">Mot de passe</label>
                    <input type="password" id="loginPassword" class="form-input" placeholder="Entre ton mot de passe">
                </div>
                <button onclick="login()" class="btn btn-primary">Se Connecter</button>
                <button onclick="showRegister()" class="btn btn-secondary">CrÃ©er un Compte</button>
            </div>

            <div id="registerForm" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Pseudo</label>
                    <input type="text" id="registerUsername" class="form-input" placeholder="Choisis ton pseudo">
                </div>
                <div class="form-group">
                    <label class="form-label">Email</label>
                    <input type="email" id="registerEmail" class="form-input" placeholder="ton@email.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Mot de passe</label>
                    <input type="password" id="registerPassword" class="form-input" placeholder="CrÃ©e un mot de passe">
                </div>
                <button onclick="register()" class="btn btn-primary">S'inscrire</button>
                <button onclick="showLogin()" class="btn btn-secondary">J'ai dÃ©jÃ  un compte</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="appPage" class="app-container">
        <nav class="navbar">
            <div class="nav-brand" onclick="showPage('home')">ğŸ® XOLBOR</div>
            <div class="nav-menu">
                <div class="nav-item" onclick="showPage('home')">Accueil</div>
                <div class="nav-item" onclick="showPage('marketplace')">Marketplace</div>
                <div class="nav-item" onclick="showPage('friends')">Amis</div>
            </div>
            <div class="nav-user" onclick="showPage('profile')">
                <div class="xubor-display">ğŸ’ <span id="userXubor">0</span></div>
                <div class="user-avatar" id="navAvatar">ğŸ‘¤</div>
                <span id="navUsername">User</span>
            </div>
        </nav>

        <div class="content">
            <!-- Home Page -->
            <div id="homePage" class="page-section active">
                <div class="search-bar">
                    <input type="text" class="search-input" placeholder="ğŸ” Rechercher un jeu..." oninput="searchGames(this.value)">
                </div>

                <h2 class="section-title">Jeux Populaires</h2>
                <div class="games-grid" id="gamesGrid"></div>
            </div>

            <!-- Marketplace Page -->
            <div id="marketplacePage" class="page-section">
                <div class="marketplace-header">
                    <h2 class="section-title">Acheter des Xubor ğŸ’</h2>
                    <div class="xubor-packages">
                        <div class="package-card" onclick="buyXubor(100, 10)">
                            <div class="package-amount">100 ğŸ’</div>
                            <div class="package-price">10â‚¬</div>
                            <button class="btn btn-primary">Acheter</button>
                        </div>
                        <div class="package-card featured" onclick="buyXubor(800, 20)">
                            <div class="package-amount">800 ğŸ’</div>
                            <div class="package-price">20â‚¬</div>
                            <div style="color: #fbbf24; font-size: 12px; margin-bottom: 8px;">â­ POPULAIRE</div>
                            <button class="btn btn-primary">Acheter</button>
                        </div>
                        <div class="package-card" onclick="buyXubor(12095, 234)">
                            <div class="package-amount">12,095 ğŸ’</div>
                            <div class="package-price">234â‚¬</div>
                            <button class="btn btn-primary">Acheter</button>
                        </div>
                        <div class="package-card featured" onclick="buyXubor(999999, 456)">
                            <div class="package-amount">âˆ ILLIMITÃ‰</div>
                            <div class="package-price">456â‚¬</div>
                            <div style="color: #ec4899; font-size: 12px; margin-bottom: 8px;">ğŸ”¥ PREMIUM</div>
                            <button class="btn btn-primary">Acheter</button>
                        </div>
                    </div>
                </div>

                <div class="search-bar">
                    <input type="text" class="search-input" placeholder="ğŸ” Rechercher un skin..." oninput="searchSkins(this.value)">
                </div>

                <h2 class="section-title">Boutique de Skins</h2>
                <div class="skins-grid" id="skinsGrid"></div>
            </div> 

            <!-- Profile Page -->
            <div id="profilePage" class="page-section">
                <div class="profile-header">
                    
                    <!-- MODIFICATION: Avatar 3D intÃ©grÃ© -->
                    <div class="profile-avatar-large" id="profileAvatar" style="background: none; border: none; padding: 0; overflow: hidden; border-radius: 50%;">
                        <!-- 
                            ModÃ¨le 3D gratuit de Sketchfab comme exemple.
                            Tu peux trouver d'autres modÃ¨les et obtenir ton propre code "embed".
                        -->
                        <iframe title="Robot Avatar" frameborder="0" allowfullscreen mozallowfullscreen="true" webkitallowfullscreen="true" allow="autoplay; fullscreen; xr-spatial-tracking" xr-spatial-tracking execution-while-out-of-viewport execution-while-not-rendered web-share src="https://sketchfab.com/models/0198811025214efc8a8167f81b1686d0/embed?autostart=1&transparent=1&ui_controls=0&ui_infos=0&ui_inspector=0&ui_watermark=0" style="width: 100%; height: 100%;">
                        </iframe>
                    </div>
                    <!-- FIN MODIFICATION -->

                    <div class="profile-username" id="profileUsername">User</div>
                    <div class="profile-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="profileXubor">0</div>
                            <div class="stat-label">Xubor</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profileSkins">0</div>
                            <div class="stat-label">Skins</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="profileFriends">0</div>
                            <div class="stat-label">Amis</div>
                        </div>
                    </div>
                    <button onclick="logout()" class="btn btn-secondary" style="max-width: 200px; margin: 20px auto 0;">DÃ©connexion</button>
                </div>

                <h2 class="section-title">Mes Skins</h2>
                <div class="skins-grid" id="mySkinsGrid"></div>
            </div>

            <!-- Friends Page -->
            <div id="friendsPage" class="page-section">
                <div class="friends-search">
                    <input type="text" class="search-input" placeholder="ğŸ” Rechercher des amis..." oninput="searchFriends(this.value)">
                </div>

                <h2 class="section-title">Mes Amis</h2>
                <div class="friends-grid" id="friendsGrid"></div>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <button onclick="closePaymentModal()" class="close-modal">&times;</button>
            <h2 class="modal-title">ğŸ’³ Paiement SÃ©curisÃ©</h2>
            <div class="form-group">
                <label class="form-label">NumÃ©ro de carte</label>
                <input type="text" class="form-input" placeholder="1234 5678 9012 3456" maxlength="19">
            </div>
            
            <!-- MODIFICATION: Formulaire de paiement corrigÃ© -->
            <div style="display: flex; gap: 16px;">
                <div class="form-group" style="flex: 2;">
                    <label class="form-label">Expiration (MM/AA)</label>
                    <input type="text" class="form-input" placeholder="MM/AA" maxlength="5">
                </div>
                <div class="form-group" style="flex: 1;">
                    <label class="form-label">CVC</label>
                    <input type="text" class="form-input" placeholder="123" maxlength="3">
                </div>
            </div>
            <!-- FIN MODIFICATION -->

            <div class="form-group">
                <label class="form-label">Nom sur la carte</label>
                <input type="text" class="form-input" placeholder="JEAN DUPONT">
            </div>
            <div id="paymentAmount" style="text-align: center; margin: 20px 0; font-size: 24px; font-weight: bold; color: var(--primary);"></div>
            <button onclick="processPayment()" class="btn btn-primary">Confirmer le paiement</button>
            <button onclick="closePaymentModal()" class="btn btn-secondary">Annuler</button>
        </div>
    </div>

    <!-- MODIFICATION: Ajout du Modal pour le Jeu -->
    <div id="gameModal" class="modal" style="padding: 10px;">
        <div class="modal-content" style="width: 95%; max-width: 1200px; height: 90vh; padding: 10px; background: var(--darker);">
            <button onclick="closeGameModal()" class="close-modal" style="z-index: 10; top: 20px; right: 25px;">&times;</button>
            <iframe id="gameFrame" style="width: 100%; height: 100%; border: none; border-radius: 16px; background: #fff;"></iframe>
        </div>
    </div>
    <!-- FIN MODIFICATION -->


    <script>
        // Ã‰tat global de l'application
        let currentUser = null;
        let currentPage = 'home';
        let pendingPurchase = null;

        // Base de donnÃ©es simulÃ©e (en production, utilisez un vrai backend)
        const DB = {
            users: {},
            load() {
                const saved = localStorage.getItem('xolborDB');
                if (saved) {
                    const data = JSON.parse(saved);
                    this.users = data.users || {};
                }
            },
            save() {
                localStorage.setItem('xolborDB', JSON.stringify({
                    users: this.users
                }));
            },
            addUser(username, email, password) {
                this.users[username.toLowerCase()] = {
                    username,
                    email,
                    password,
                    xubor: 0,
                    avatar: 'ğŸ‘¤',
                    skins: [],
                    friends: []
                };
                this.save();
            },
            getUser(username) {
                return this.users[username.toLowerCase()];
            },
            updateUser(username, data) {
                const user = this.getUser(username);
                if (user) {
                    Object.assign(user, data);
                    this.save();
                }
            }
        };

        // Jeux disponibles
        const games = [
            { id: 1, name: 'Steal a Brainrot', icon: 'ğŸ§ ', players: 15420, likes: 98 },
            // MODIFICATION: Jeu 2 mis Ã  jour
            { id: 2, name: 'Super Platformer', icon: 'ğŸƒ', players: 28934, likes: 95 },
            { id: 3, name: 'Tower Defense Ultimate', icon: 'ğŸ—¼', players: 12389, likes: 92 },
            { id: 4, name: 'Racing Legends', icon: 'ğŸï¸', players: 45231, likes: 97 },
            // MODIFICATION: Jeu 5 mis Ã  jour
            { id: 5, name: 'Tunnel Go 3D', icon: 'ğŸŒ€', players: 32145, likes: 93 },
            // MODIFICATION: Jeu 6 mis Ã  jour
            { id: 6, name: 'Slope 3D', icon: 'ğŸ‚', players: 19823, likes: 91 },
            // MODIFICATION: Jeu 7 mis Ã  jour
            { id: 7, name: '3D Racing', icon: 'ğŸï¸', players: 52341, likes: 99 },
            // FIN MODIFICATION
            { id: 8, name: 'Tycoon Empire', icon: 'ğŸ’°', players: 23456, likes: 89 },
            { id: 9, name: 'Parkour Masters', icon: 'ğŸ¤¸', players: 18765, likes: 94 },
            { id: 10, name: 'Murder Mystery', icon: 'ğŸ”ª', players: 34567, likes: 96 },
            { id: 11, name: 'Sword Fighting Arena', icon: 'âš”ï¸', players: 16432, likes: 90 },
            { id: 12, name: 'Roleplay City Life', icon: 'ğŸ™ï¸', players: 41234, likes: 88 },
            { id: 13, name: 'Dragon Adventures', icon: 'ğŸ‰', players: 27891, likes: 97 },
            { id: 14, name: 'Space Exploration', icon: 'ğŸš€', players: 14567, likes: 93 },
            { id: 15, name: 'Ninja Warrior', icon: 'ğŸ¥·', players: 22341, likes: 95 },
            { id: 16, name: 'Fashion Show', icon: 'ğŸ‘—', players: 31245, likes: 87 },
            { id: 17, name: 'Restaurant Tycoon', icon: 'ğŸ”', players: 19876, likes: 91 },
            { id: 18, name: 'Military Simulator', icon: 'ğŸ–ï¸', players: 25432, likes: 92 },
            { id: 19, name: 'Magic School', icon: 'ğŸ§™', players: 36789, likes: 96 },
            { id: 20, name: 'Dance Battle', icon: 'ğŸ’ƒ', players: 28765, likes: 89 }
        ];
        
        // MODIFICATION: Ajout des liens pour les jeux
        const gameLinks = {
            1: 'https://patorjk.com/games/snake/', // Jeu 1: Snake
            // MODIFICATION: Liens des jeux 2, 5, 6, 7 mis Ã  jour
            2: 'https://cdn.htmlgames.com/SuperPlatformer/', // Jeu 2: Super Platformer
            3: 'https://solitaire-web.web.app/', // Jeu 3: Solitaire
            4: 'https://98.js.org/programs/minesweeper/', // Jeu 4: DÃ©mineur
            5: 'https://cdn.htmlgames.com/TunnelGo/', // Jeu 5: Tunnel Go 3D
            6: 'https://cdn.htmlgames.com/Slope/', // Jeu 6: Slope 3D
            7: 'https://cdn.htmlgames.com/3dRacing/', // Jeu 7: 3D Racing
            // FIN MODIFICATION
            // Ajoute les autres ID de jeux ici avec un lien vers un jeu HTML5
        };
        // FIN MODIFICATION

        // Skins disponibles
        const skins = [];
        const skinEmojis = ['ğŸ‘¨', 'ğŸ‘©', 'ğŸ§‘', 'ğŸ‘¦', 'ğŸ‘§', 'ğŸ‘´', 'ğŸ‘µ', 'ğŸ§”', 'ğŸ‘¨â€ğŸ¦°', 'ğŸ‘¨â€ğŸ¦±', 'ğŸ‘¨â€ğŸ¦³', 'ğŸ‘¨â€ğŸ¦²', 'ğŸ‘©â€ğŸ¦°', 'ğŸ‘©â€ğŸ¦±', 'ğŸ‘©â€ğŸ¦³', 'ğŸ‘©â€ğŸ¦²', 'ğŸ§‘â€ğŸ¦°', 'ğŸ§‘â€ğŸ¦±', 'ğŸ§‘â€ğŸ¦³', 'ğŸ§‘â€ğŸ¦²', 'ğŸ‘±â€â™€ï¸', 'ğŸ‘±â€â™‚ï¸', 'ğŸ§“', 'ğŸ‘²', 'ğŸ‘³â€â™€ï¸', 'ğŸ‘³â€â™‚ï¸', 'ğŸ§•', 'ğŸ‘®â€â™€ï¸', 'ğŸ‘®â€â™‚ï¸', 'ğŸ‘·â€â™€ï¸', 'ğŸ‘·â€â™‚ï¸', 'ğŸ’‚â€â™€ï¸', 'ğŸ’‚â€â™‚ï¸', 'ğŸ•µï¸â€â™€ï¸', 'ğŸ•µï¸â€â™‚ï¸', 'ğŸ‘©â€âš•ï¸', 'ğŸ‘¨â€âš•ï¸', 'ğŸ‘©â€ğŸŒ¾', 'ğŸ‘¨â€ğŸŒ¾', 'ğŸ‘©â€ğŸ³', 'ğŸ‘¨â€ğŸ³', 'ğŸ‘©â€ğŸ“', 'ğŸ‘¨â€ğŸ“', 'ğŸ‘©â€ğŸ¤', 'ğŸ‘¨â€ğŸ¤', 'ğŸ‘©â€ğŸ«', 'ğŸ‘¨â€ğŸ«', 'ğŸ‘©â€ğŸ­', 'ğŸ‘¨â€ğŸ­', 'ğŸ‘©â€ğŸ’»', 'ğŸ‘¨â€ğŸ’»', 'ğŸ‘©â€ğŸ’¼', 'ğŸ‘¨â€ğŸ’¼', 'ğŸ‘©â€ğŸ”§', 'ğŸ‘¨â€ğŸ”§', 'ğŸ‘©â€ğŸ”¬', 'ğŸ‘¨â€ğŸ”¬', 'ğŸ‘©â€ğŸ¨', 'ğŸ‘¨â€ğŸ¨', 'ğŸ‘©â€ğŸš’', 'ğŸ‘¨â€ğŸš’', 'ğŸ‘©â€âœˆï¸', 'ğŸ‘¨â€âœˆï¸', 'ğŸ‘©â€ğŸš€', 'ğŸ‘¨â€ğŸš€', 'ğŸ‘©â€âš–ï¸', 'ğŸ‘¨â€âš–ï¸', 'ğŸ‘°', 'ğŸ¤µ', 'ğŸ‘¸', 'ğŸ¤´', 'ğŸ¦¸â€â™€ï¸', 'ğŸ¦¸â€â™‚ï¸', 'ğŸ¦¹â€â™€ï¸', 'ğŸ¦¹â€â™‚ï¸', 'ğŸ§™â€â™€ï¸', 'ğŸ§™â€â™‚ï¸', 'ğŸ§šâ€â™€ï¸', 'ğŸ§šâ€â™‚ï¸', 'ğŸ§›â€â™€ï¸', 'ğŸ§›â€â™‚ï¸', 'ğŸ§œâ€â™€ï¸', 'ğŸ§œâ€â™‚ï¸', 'ğŸ§â€â™€ï¸', '_TOKEN_404_'];
        const skin3dEmojis = ['ğŸ¤–', 'ğŸ‘¾', 'ğŸƒ', 'ğŸ‘»', 'ğŸ’€', 'â˜ ï¸', 'ğŸ‘½', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ¤¡', 'ğŸ’©', 'ğŸ¦–', 'ğŸ¦•', 'ğŸ‰', 'ğŸ²', 'ğŸ§Ÿâ€â™‚ï¸', 'ğŸ§Ÿâ€â™€ï¸', 'ğŸ§™â€â™‚ï¸', 'ğŸ§™â€â™€ï¸', 'ğŸ§›â€â™‚ï¸', 'ğŸ§›â€â™€ï¸'];
        const legendarySkinEmojis = ['ğŸ¦„', 'ğŸ‰', 'ğŸ²', 'ğŸ¦–', 'ğŸ¦•', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ§â€â™‚ï¸', 'ğŸ§â€â™€ï¸', 'ğŸ§œâ€â™‚ï¸', 'ğŸ§œâ€â™€ï¸', 'ğŸ§šâ€â™‚ï¸', 'ğŸ§šâ€â™€ï¸', 'ğŸ¤´', 'ğŸ‘¸'];
        const epicSkinEmojis = ['ğŸ§™â€â™‚ï¸', 'ğŸ§™â€â™€ï¸', 'ğŸ§›â€â™‚ï¸', 'ğŸ§›â€â™€ï¸', 'ğŸ¤–', 'ğŸ‘¾', 'ğŸƒ', 'ğŸ‘»', 'ğŸ’€', 'â˜ ï¸', 'ğŸ‘½', 'ğŸ‘¹', 'ğŸ‘º', 'ğŸ¤¡', 'ğŸ’©'];
        const rareSkinEmojis = ['ğŸ¦¸â€â™‚ï¸', 'ğŸ¦¸â€â™€ï¸', 'ğŸ¦¹â€â™‚ï¸', 'ğŸ¦¹â€â™€ï¸', 'ğŸ‘‘', 'ğŸ›¡ï¸', 'âš”ï¸', 'ğŸ”®', 'ğŸ”¥', 'â„ï¸', 'ğŸŒŸ', 'ğŸŒˆ', 'âš¡', 'ğŸ’¥', 'ğŸŒªï¸', 'ğŸŒŠ', 'ğŸŒ', 'ğŸŒ™', 'â˜€ï¸', 'â­'];
        const allSkinEmojis = skinEmojis.concat(skin3dEmojis);

        for (let i = 0; i < 120; i++) {
            const emoji = skinEmojis[i % skinEmojis.length];
            const rarity = i < 20 ? 'LÃ©gendaire' : i < 50 ? 'Ã‰pique' : i < 80 ? 'Rare' : 'Commun';
            const price = i < 20 ? 500 : i < 50 ? 250 : i < 80 ? 100 : 50;
            skins.push({
                id: i + 1,
                name: `Skin ${rarity} ${i + 1}`,
                emoji: emoji,
                price: price,
                rarity: rarity
            });
        }

        // Amis suggÃ©rÃ©s
        const suggestedFriends = [
            { username: 'ProGamer123', avatar: 'ğŸ®', status: 'En ligne' },
            { username: 'NinjaWarrior', avatar: 'ğŸ¥·', status: 'En jeu' },
            { username: 'DragonMaster', avatar: 'ğŸ‰', status: 'Hors ligne' },
            { username: 'SpeedRunner99', avatar: 'âš¡', status: 'En ligne' },
            { username: 'BuilderKing', avatar: 'ğŸ—ï¸', status: 'En ligne' },
            { username: 'PetCollector', avatar: 'ğŸ¾', status: 'En jeu' },
            { username: 'TycoonBoss', avatar: 'ğŸ’°', status: 'En ligne' },
            { username: 'ZombieHunter', avatar: 'ğŸ§Ÿ', status: 'Hors ligne' }
        ];

        // Initialisation
        DB.load();

        // Fonctions d'authentification
        function showError(message) {
            const errorEl = document.getElementById('errorMessage');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            setTimeout(() => {
                errorEl.style.display = 'none';
            }, 3000);
        }

        function showLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').style.display = 'none';
        }

        function showRegister() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
        }

        function register() {
            const username = document.getElementById('registerUsername').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const password = document.getElementById('registerPassword').value;

            if (!username || !email || !password) {
                showError('Tous les champs sont obligatoires !');
                return;
            }

            if (username.length < 3) {
                showError('Le pseudo doit contenir au moins 3 caractÃ¨res !');
                return;
            }

            if (DB.getUser(username)) {
                showError('Ce pseudo existe dÃ©jÃ  ! Choisis-en un autre.');
                return;
            }

            if (!email.includes('@')) {
                showError('Email invalide !');
                return;
            }

            if (password.length < 6) {
                showError('Le mot de passe doit contenir au moins 6 caractÃ¨res !');
                return;
            }

            DB.addUser(username, email, password);
            showError('Compte crÃ©Ã© avec succÃ¨s ! Connecte-toi maintenant.');
            setTimeout(() => {
                showLogin();
            }, 1500);
        }

        function login() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;

            if (!username || !password) {
                showError('Entre ton pseudo et mot de passe !');
                return;
            }

            const user = DB.getUser(username);
            if (!user) {
                showError('Ce compte n\'existe pas !');
                return;
            }

            if (user.password !== password) {
                showError('Mot de passe incorrect !');
                return;
            }

            currentUser = user;
            localStorage.setItem('xolborCurrentUser', username);
            showApp();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('xolborCurrentUser');
            document.getElementById('authPage').style.display = 'flex';
            document.getElementById('appPage').style.display = 'none';
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
        }

        function showApp() {
            document.getElementById('authPage').style.display = 'none';
            document.getElementById('appPage').style.display = 'block';
            updateUI();
            renderGames();
            renderSkins();
            renderFriends();
        }

        function updateUI() {
            document.getElementById('navUsername').textContent = currentUser.username;
            document.getElementById('navAvatar').textContent = currentUser.avatar;
            document.getElementById('userXubor').textContent = currentUser.xubor.toLocaleString();
            document.getElementById('profileUsername').textContent = currentUser.username;
            
            // Ne pas Ã©craser l'avatar 3D si c'est la page de profil
            if (currentPage !== 'profile') {
                // Si l'avatar 3D est visible (sur la page profil), ne le remplace pas par l'emoji
                // Cette logique est un peu inversÃ©e, corrigeons-la.
                // L'avatar 3D est DANS la page profil, donc il ne sera pas affectÃ©.
                // On met Ã  jour le petit avatar de la nav bar
                document.getElementById('navAvatar').textContent = currentUser.avatar;
            }
             // Mettre Ã  jour le petit avatar de la nav bar
             document.getElementById('navAvatar').textContent = currentUser.avatar;


            document.getElementById('profileXubor').textContent = currentUser.xubor.toLocaleString();
            document.getElementById('profileSkins').textContent = currentUser.skins.length;
            document.getElementById('profileFriends').textContent = currentUser.friends.length;
            renderMySkins();
        }

        // Navigation
        function showPage(page) {
            document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));
            document.getElementById(page + 'Page').classList.add('active');
            currentPage = page;
            // Assurer que l'UI est Ã  jour, surtout pour l'avatar
            updateUI();
        }

        // Rendu des jeux
        function renderGames(filter = '') {
            const grid = document.getElementById('gamesGrid');
            const filteredGames = filter ? games.filter(g => g.name.toLowerCase().includes(filter.toLowerCase())) : games;
            
            grid.innerHTML = filteredGames.map(game => `
                <div class="game-card" onclick="playGame(${game.id})">
                    <div class="game-thumbnail">${game.icon}</div>
                    <div class="game-info">
                        <div class="game-title">${game.name}</div>
                        <div class="game-stats">
                            <span>ğŸ‘¥ ${game.players.toLocaleString()}</span>
                            <span>ğŸ‘ ${game.likes}%</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function searchGames(query) {
            renderGames(query);
        }

        // MODIFICATION: Fonction playGame mise Ã  jour
        function playGame(id) {
            const game = games.find(g => g.id === id);
            const gameUrl = gameLinks[id]; // RÃ©cupÃ¨re le lien du jeu

            if (gameUrl) {
                document.getElementById('gameFrame').src = gameUrl;
                document.getElementById('gameModal').classList.add('active');
            } else {
                // Utilise une boÃ®te de dialogue personnalisÃ©e au lieu de alert()
                showCustomAlert(`ğŸ® Le jeu "${game.name}" n'est pas encore disponible !`);
            }
        }

        // MODIFICATION: Fonction pour fermer le modal du jeu
        function closeGameModal() {
            document.getElementById('gameModal').classList.remove('active');
            document.getElementById('gameFrame').src = 'about:blank'; // ArrÃªte le jeu pour libÃ©rer la mÃ©moire
        }
        // FIN MODIFICATION

        // Rendu des skins
        function renderSkins(filter = '') {
            const grid = document.getElementById('skinsGrid');
            const filteredSkins = filter ? skins.filter(s => s.name.toLowerCase().includes(filter.toLowerCase())) : skins;
            
            grid.innerHTML = filteredSkins.map(skin => {
                const owned = currentUser.skins.includes(skin.id);
                const canBuy = currentUser.xubor >= skin.price;
                return `
                    <div class="skin-card">
                        <div class="skin-preview">${skin.emoji}</div>
                        <div class="skin-info">
                            <div class="skin-name">${skin.name}</div>
                            <div class="skin-price">${skin.price} ğŸ’</div>
                            <button class="btn-buy" onclick="buySkin(${skin.id})" 
                                ${owned ? 'disabled' : ''} 
                                ${!canBuy && !owned ? 'disabled' : ''}>
                                ${owned ? 'âœ“ PossÃ©dÃ©' : canBuy ? 'Acheter' : 'Pas assez de ğŸ’'}
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function searchSkins(query) {
            renderSkins(query);
        }

        function renderMySkins() {
            const grid = document.getElementById('mySkinsGrid');
            const mySkins = skins.filter(s => currentUser.skins.includes(s.id));
            
            if (mySkins.length === 0) {
                grid.innerHTML = '<p style="text-align: center; color: #94a3b8;">Tu n\'as pas encore de skins. Visite le Marketplace !</p>';
                return;
            }

            grid.innerHTML = mySkins.map(skin => `
                <div class="skin-card">
                    <div class="skin-preview">${skin.emoji}</div>
                    <div class="skin-info">
                        <div class="skin-name">${skin.name}</div>
                        <button class="btn-buy" onclick="equipSkin(${skin.id})">
                            ${currentUser.avatar === skin.emoji ? 'âœ“ Ã‰quipÃ©' : 'Ã‰quiper'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function buySkin(skinId) {
            const skin = skins.find(s => s.id === skinId);
            if (!skin) return;

            if (currentUser.xubor < skin.price) {
                showCustomAlert('âŒ Tu n\'as pas assez de Xubor !\n\nVisite la section "Acheter des Xubor" dans le Marketplace.');
                return;
            }

            if (currentUser.skins.includes(skinId)) {
                showCustomAlert('âœ“ Tu possÃ¨des dÃ©jÃ  ce skin !');
                return;
            }

            // Utilise une boÃ®te de dialogue personnalisÃ©e au lieu de confirm()
            showCustomConfirm(`Acheter ${skin.name} pour ${skin.price} ğŸ’ ?`, () => {
                currentUser.xubor -= skin.price;
                currentUser.skins.push(skinId);
                DB.updateUser(currentUser.username, currentUser);
                updateUI();
                renderSkins();
                showCustomAlert(`âœ“ ${skin.name} achetÃ© avec succÃ¨s !`);
            });
        }

        function equipSkin(skinId) {
            const skin = skins.find(s => s.id === skinId);
            if (!skin) return;

            currentUser.avatar = skin.emoji;
            DB.updateUser(currentUser.username, currentUser);
            updateUI();
            showCustomAlert(`âœ“ ${skin.name} Ã©quipÃ© !`);
        }

        // SystÃ¨me de Xubor
        function buyXubor(amount, price) {
            pendingPurchase = { amount, price };
            document.getElementById('paymentAmount').textContent = `${amount} ğŸ’ Xubor pour ${price}â‚¬`;
            document.getElementById('paymentModal').classList.add('active');
        }

        function processPayment() {
            if (!pendingPurchase) return;

            // En production, ici vous intÃ©greriez Stripe, PayPal, etc.
            showCustomAlert(`âœ“ Paiement de ${pendingPurchase.price}â‚¬ simulÃ© avec succÃ¨s !\n\n+${pendingPurchase.amount} ğŸ’ Xubor ajoutÃ©s !`);
            
            currentUser.xubor += pendingPurchase.amount;
            DB.updateUser(currentUser.username, currentUser);
            updateUI();
            closePaymentModal();
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.remove('active');
            pendingPurchase = null;
        }

        // SystÃ¨me d'amis
        function renderFriends(filter = '') {
            const grid = document.getElementById('friendsGrid');
            const allFriends = [...currentUser.friends, ...suggestedFriends];
            const filteredFriends = filter ? 
                allFriends.filter(f => f.username.toLowerCase().includes(filter.toLowerCase())) : 
                allFriends;
            
            grid.innerHTML = filteredFriends.map(friend => {
                const isFriend = currentUser.friends.some(f => f.username === friend.username);
                return `
                    <div class="friend-card">
                        <div class="friend-avatar">${friend.avatar}</div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">${friend.username}</div>
                            <div style="font-size: 12px; color: #94a3b8;">${friend.status}</div>
                        </div>
                        <button class="btn-buy" onclick="addFriend('${friend.username}', '${friend.avatar}', '${friend.status}')" 
                            ${isFriend ? 'disabled' : ''}>
                            ${isFriend ? 'âœ“ Ami' : '+ Ajouter'}
                        </button>
                    </div>
                `;
            }).join('');
        }

        function searchFriends(query) {
            renderFriends(query);
        }

        function addFriend(username, avatar, status) {
            if (currentUser.friends.some(f => f.username === username)) {
                showCustomAlert('DÃ©jÃ  dans tes amis !');
                return;
            }

            currentUser.friends.push({ username, avatar, status });
            DB.updateUser(currentUser.username, currentUser);
            updateUI();
            renderFriends();
            showCustomAlert(`âœ“ ${username} ajoutÃ© Ã  tes amis !`);
        }
        
        // --- Fonctions utilitaires pour remplacer alert() et confirm() ---

        // Fonction pour afficher une alerte personnalisÃ©e
        function showCustomAlert(message) {
            // CrÃ©e les Ã©lÃ©ments du DOM pour l'alerte
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'modal active';
            modalOverlay.style.zIndex = '2000'; // S'assurer qu'elle est au-dessus de tout

            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            modalContent.style.maxWidth = '400px';
            modalContent.style.textAlign = 'center';

            const messageText = document.createElement('p');
            messageText.textContent = message;
            messageText.style.marginBottom = '20px';
            messageText.style.fontSize = '16px';
            messageText.style.whiteSpace = 'pre-wrap'; // Pour respecter les sauts de ligne \n

            const okButton = document.createElement('button');
            okButton.textContent = 'OK';
            okButton.className = 'btn btn-primary';
            
            // Fonction pour fermer l'alerte
            const closeModal = () => {
                if (document.body.contains(modalOverlay)) {
                    document.body.removeChild(modalOverlay);
                }
            };

            okButton.onclick = closeModal;

            modalContent.appendChild(messageText);
            modalContent.appendChild(okButton);
            modalOverlay.appendChild(modalContent);
            document.body.appendChild(modalOverlay);
        }

        // Fonction pour afficher une confirmation personnalisÃ©e
        function showCustomConfirm(message, onConfirm) {
            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'modal active';
            modalOverlay.style.zIndex = '2000';

            const modalContent = document.createElement('div');
            modalContent.className = 'modal-content';
            modalContent.style.maxWidth = '400px';
            modalContent.style.textAlign = 'center';

            const messageText = document.createElement('p');
            messageText.textContent = message;
            messageText.style.marginBottom = '24px';
            messageText.style.fontSize = '16px';

            const confirmButton = document.createElement('button');
            confirmButton.textContent = 'Confirmer';
            confirmButton.className = 'btn btn-primary';
            confirmButton.style.marginRight = '10px';

            const cancelButton = document.createElement('button');
            cancelButton.textContent = 'Annuler';
            cancelButton.className = 'btn btn-secondary';
            cancelButton.style.marginTop = '0'; // Annuler le margin-top par dÃ©faut

            const closeModal = () => {
                if (document.body.contains(modalOverlay)) {
                    document.body.removeChild(modalOverlay);
                }
            };

            confirmButton.onclick = () => {
                onConfirm(); // ExÃ©cute la fonction de callback
                closeModal();
            };
            
            cancelButton.onclick = closeModal;

            modalContent.appendChild(messageText);
            modalContent.appendChild(confirmButton);
            modalContent.appendChild(cancelButton);
            modalOverlay.appendChild(modalContent);
            document.body.appendChild(modalOverlay);
        }
        
        // Remplacer les alert() et confirm() restantes
        const originalAlert = window.alert;
        window.alert = showCustomAlert;
        const originalConfirm = window.confirm;
        window.confirm = (message) => {
            // confirm() retourne un boolÃ©en, mais notre fonction personnalisÃ©e est asynchrone.
            // Pour ce cas d'utilisation, nous allons le rediriger vers showCustomConfirm
            // mais cela ne fonctionnera pas pour les `if (confirm(...))` synchrones.
            // Heureusement, nous les avons dÃ©jÃ  remplacÃ©s manuellement.
            console.warn("Utilisation de window.confirm() interceptÃ©e. Remplacez par showCustomConfirm(message, callback).");
            // Pour l'instant, on affiche juste une alerte.
            showCustomAlert(message);
            return false; // Simule un "Annuler" pour Ã©viter les actions non dÃ©sirÃ©es
        };


        // VÃ©rifier si l'utilisateur est dÃ©jÃ  connectÃ©
        window.onload = function() {
            const savedUser = localStorage.getItem('xolborCurrentUser');
            if (savedUser) {
                const user = DB.getUser(savedUser);
                if (user) {
                    currentUser = user;
                    showApp();
                }
            }
        };
    </script>
   <h6>CrÃ©er par Imraneâ¤ï¸â€‹</h6>
</body>
</html>

