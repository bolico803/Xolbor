<!doctype html>
<html lang="fr">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Xolbor - Plateforme de Jeux 3D</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100%;
            overflow-x: hidden;
        }

        * {
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100%;
        }

        /* Page de connexion */
        .auth-page {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100%;
            padding: 20px;
        }

        .auth-card {
            background: white;
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 450px;
            animation: slideUp 0.5s ease-out;
            transform-style: preserve-3d;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px) rotateX(10deg);
            }
            to {
                opacity: 1;
                transform: translateY(0) rotateX(0deg);
            }
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 15px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotateY(0deg); }
            50% { transform: translateY(-10px) rotateY(180deg); }
        }

        .logo h1 {
            margin: 0;
            font-size: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 15px;
            transition: all 0.3s;
            background: rgba(255,255,255,0.9);
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            transform-style: preserve-3d;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-3px) rotateX(5deg);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.6);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
            transform: translateY(-2px);
        }

        .error-message, .success-message {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        .error-message {
            background: #fee;
            color: #c33;
            border-left: 4px solid #c33;
        }

        .success-message {
            background: #efe;
            color: #3c3;
            border-left: 4px solid #3c3;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Page principale */
        .main-page {
            display: none;
        }

        .header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            flex-wrap: wrap;
            gap: 15px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .header-logo {
            width: 50px;
            height: 50px;
            animation: spin 10s linear infinite;
        }

        @keyframes spin {
            from { transform: rotateY(0deg); }
            to { transform: rotateY(360deg); }
        }

        .header h2 {
            margin: 0;
            color: #333;
            font-size: 24px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .xubor-display {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            padding: 12px 20px;
            border-radius: 20px;
            font-weight: 700;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .profile-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid #667eea;
            cursor: pointer;
            transition: all 0.3s;
            overflow: hidden;
            background: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            transform-style: preserve-3d;
        }

        .profile-btn:hover {
            transform: scale(1.1) rotateY(180deg);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
        }

        .profile-avatar {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 12px 24px;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            color: #666;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transform-style: preserve-3d;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-3px) rotateX(5deg);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .nav-tab:hover:not(.active) {
            transform: translateY(-2px);
            background: rgba(255,255,255,1);
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .search-bar {
            width: 100%;
            padding: 16px 24px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 12px;
            font-size: 15px;
            margin-bottom: 20px;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .search-bar:focus {
            outline: none;
            background: white;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .game-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.4s;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }

        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .game-card:hover::before {
            opacity: 1;
        }

        .game-card:hover {
            transform: translateY(-10px) rotateX(5deg) rotateY(5deg);
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .game-icon {
            width: 100%;
            height: 150px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 4px 8px rgba(0,0,0,0.1);
        }

        .game-icon::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
            animation: shine 3s ease-in-out infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            50% { transform: translateX(100%) translateY(100%) rotate(45deg); }
            100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        }

        .game-card h3 {
            margin: 0 0 8px 0;
            color: #333;
            font-size: 20px;
            position: relative;
            z-index: 1;
        }

        .game-card p {
            margin: 0 0 15px 0;
            color: #666;
            font-size: 14px;
            position: relative;
            z-index: 1;
        }

        .play-badge {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            display: inline-block;
            animation: bounce 2s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }

        .coming-soon-badge {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            display: inline-block;
            position: relative;
            z-index: 1;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        /* Modal de jeu */
        .game-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .game-modal.active {
            display: flex;
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .game-container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 90%;
            max-height: 90%;
            overflow: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transform-style: preserve-3d;
            animation: gameSlideIn 0.5s ease-out;
        }

        @keyframes gameSlideIn {
            from { 
                opacity: 0; 
                transform: translateY(50px) rotateX(10deg); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) rotateX(0deg); 
            }
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .close-game {
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
        }

        .close-game:hover {
            background: #ff5252;
            transform: rotate(90deg);
        }

        .game-canvas {
            border: 3px solid #667eea;
            border-radius: 12px;
            display: block;
            margin: 0 auto;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .game-controls {
            margin-top: 20px;
            text-align: center;
        }

        .game-score {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 15px;
        }

        .game-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s;
        }

        .game-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        /* Marketplace amÃ©liorÃ© */
        .skins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
        }

        .skin-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: all 0.4s;
            border: 1px solid rgba(255,255,255,0.2);
            transform-style: preserve-3d;
        }

        .skin-card:hover {
            transform: translateY(-8px) rotateX(5deg);
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }

        .skin-preview {
            width: 100%;
            height: 140px;
            border-radius: 12px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 4px 8px rgba(0,0,0,0.1);
        }

        .skin-preview::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
            animation: skinShine 4s ease-in-out infinite;
        }

        @keyframes skinShine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            25% { transform: translateX(100%) translateY(100%) rotate(45deg); }
            100% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        }

        .skin-name {
            font-weight: 700;
            margin-bottom: 10px;
            color: #333;
            font-size: 16px;
        }

        .skin-price {
            color: #ffd700;
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 18px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn-buy {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 14px;
        }

        .btn-buy:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-buy:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Profil amÃ©liorÃ© */
        .profile-section {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .profile-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .profile-avatar-large {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            border: 5px solid #667eea;
            margin: 0 auto 25px;
            overflow: hidden;
            background: white;
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.3);
            transition: all 0.3s;
            transform-style: preserve-3d;
        }

        .profile-avatar-large:hover {
            transform: rotateY(180deg) scale(1.05);
        }

        .profile-avatar-large img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-username {
            font-size: 32px;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .profile-level {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 700;
            display: inline-block;
            margin-bottom: 20px;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
            transition: all 0.3s;
            transform-style: preserve-3d;
        }

        .stat-card:hover {
            transform: translateY(-5px) rotateX(5deg);
            box-shadow: 0 15px 45px rgba(102, 126, 234, 0.4);
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* SystÃ¨me d'amis amÃ©liorÃ© */
        .friends-section {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .friends-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .friend-card {
            background: rgba(248,250,252,0.8);
            padding: 20px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.3s;
            border: 2px solid transparent;
            transform-style: preserve-3d;
            position: relative;
        }

        .friend-card:hover {
            background: rgba(255,255,255,0.9);
            border-color: #667eea;
            transform: translateY(-3px) rotateX(2deg);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .friend-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            font-weight: 700;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            transition: all 0.3s;
        }

        .friend-card:hover .friend-avatar {
            transform: rotateY(180deg);
        }

        .friend-info {
            flex: 1;
        }

        .friend-name {
            font-weight: 700;
            color: #333;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .friend-status {
            color: #666;
            font-size: 14px;
        }

        .friend-level {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
        }

        .online-indicator {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4ade80;
            box-shadow: 0 0 0 2px white, 0 0 10px rgba(74, 222, 128, 0.5);
            animation: pulse-online 2s ease-in-out infinite;
        }

        .offline-indicator {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #9ca3af;
            box-shadow: 0 0 0 2px white;
        }

        @keyframes pulse-online {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* Boutique Xubor amÃ©liorÃ©e */
        .xubor-shop {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }

        .xubor-pack {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 15px 45px rgba(0,0,0,0.1);
            transition: all 0.4s;
            border: 3px solid transparent;
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }

        .xubor-pack::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 237, 78, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .xubor-pack:hover::before {
            opacity: 1;
        }

        .xubor-pack:hover {
            transform: translateY(-10px) rotateX(5deg) rotateY(5deg);
            border-color: #667eea;
            box-shadow: 0 25px 70px rgba(0,0,0,0.2);
        }

        .xubor-pack.featured {
            border-color: #ffd700;
            background: linear-gradient(135deg, #fff9e6 0%, #ffffff 100%);
            box-shadow: 0 20px 60px rgba(255, 215, 0, 0.2);
        }

        .xubor-amount {
            font-size: 56px;
            font-weight: 700;
            color: #ffd700;
            margin-bottom: 15px;
            text-shadow: 0 4px 8px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
        }

        .xubor-price {
            font-size: 36px;
            font-weight: 700;
            color: #333;
            margin-bottom: 25px;
            position: relative;
            z-index: 1;
        }

        .btn-purchase {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            z-index: 1;
        }

        .btn-purchase:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .demo-badge {
            background: #ff6b6b;
            color: white;
            padding: 6px 16px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 700;
            display: inline-block;
            margin-top: 15px;
            animation: wiggle 2s ease-in-out infinite;
            position: relative;
            z-index: 1;
        }

        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-3deg); }
            75% { transform: rotate(3deg); }
        }

        .logout-btn {
            padding: 12px 20px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .logout-btn:hover {
            background: #ff5252;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }

        /* Responsive amÃ©liorÃ© */
        @media (max-width: 768px) {
            .auth-card {
                padding: 30px 20px;
                margin: 10px;
            }

            .header {
                flex-direction: column;
                align-items: stretch;
            }

            .header-right {
                justify-content: space-between;
            }

            .games-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }

            .skins-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }

            .profile-avatar-large {
                width: 140px;
                height: 140px;
            }

            .game-container {
                padding: 20px;
                margin: 10px;
            }

            .nav-tabs {
                overflow-x: auto;
                padding-bottom: 10px;
            }

            .nav-tab {
                white-space: nowrap;
                min-width: fit-content;
            }
        }

        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        /* Animations de particules */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
            animation: float-particle 6s ease-in-out infinite;
        }

        @keyframes float-particle {
            0%, 100% { 
                transform: translateY(100vh) translateX(0px) rotate(0deg);
                opacity: 0;
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                transform: translateY(-10px) translateX(100px) rotate(360deg);
                opacity: 0;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Particules d'arriÃ¨re-plan -->
  <div class="particles" id="particles"></div>
  <div id="authPage" class="auth-page">
   <div class="auth-card">
    <div class="logo">
     <svg class="logo-icon" viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><defs>
       <lineargradient id="logoGrad" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
        <stop offset="100%" style="stop-color:#a855f7;stop-opacity:1" />
       </lineargradient>
      </defs> <circle cx="50" cy="50" r="45" fill="url(#logoGrad)" /> <text x="50" y="65" font-family="Arial" font-size="50" font-weight="bold" fill="white" text-anchor="middle">
       X
      </text>
     </svg>
     <h1 id="appTitle">Xolbor</h1>
    </div>
    <div id="errorMessage" class="error-message"></div>
    <div id="successMessage" class="success-message"></div>
    <form id="loginForm">
     <div class="form-group"><label for="loginUsername">Nom d'utilisateur</label> <input type="text" id="loginUsername" required>
     </div>
     <div class="form-group"><label for="loginPassword">Mot de passe</label> <input type="password" id="loginPassword" required>
     </div><button type="submit" class="btn btn-primary">Se connecter</button> <button type="button" class="btn btn-secondary" id="showRegisterBtn">CrÃ©er un compte</button>
    </form>
    <form id="registerForm" style="display: none;">
     <div class="form-group"><label for="registerUsername">Nom d'utilisateur</label> <input type="text" id="registerUsername" required minlength="3">
     </div>
     <div class="form-group"><label for="registerPassword">Mot de passe</label> <input type="password" id="registerPassword" required minlength="6">
     </div>
     <div class="form-group"><label for="registerPasswordConfirm">Confirmer le mot de passe</label> <input type="password" id="registerPasswordConfirm" required minlength="6">
     </div><button type="submit" class="btn btn-primary">S'inscrire</button> <button type="button" class="btn btn-secondary" id="showLoginBtn">Retour Ã  la connexion</button>
    </form>
   </div>
  </div>
  <div id="mainPage" class="main-page">
   <div class="container">
    <div class="header">
     <div class="header-left">
      <svg class="header-logo" viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><defs>
        <lineargradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="100%">
         <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
         <stop offset="100%" style="stop-color:#a855f7;stop-opacity:1" />
        </lineargradient>
       </defs> <circle cx="50" cy="50" r="45" fill="url(#headerGrad)" /> <text x="50" y="65" font-family="Arial" font-size="50" font-weight="bold" fill="white" text-anchor="middle">
        X
       </text>
      </svg>
      <h2 id="welcomeMessage">Bienvenue sur Xolbor</h2>
     </div>
     <div class="header-right">
      <div class="xubor-display"><span>ğŸ’°</span> <span id="xuborAmount">0</span> <span>Xubor</span>
      </div>
      <div class="profile-btn" id="profileBtn"><img id="headerAvatar" class="profile-avatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23667eea'/%3E%3Ctext x='50' y='65' font-family='Arial' font-size='40' font-weight='bold' fill='white' text-anchor='middle'%3EğŸ‘¤%3C/text%3E%3C/svg%3E" alt="Profil">
      </div><button class="logout-btn" id="logoutBtn">DÃ©connexion</button>
     </div>
    </div>
    <div class="nav-tabs"><button class="nav-tab active" data-tab="home">ğŸ® Jeux</button> <button class="nav-tab" data-tab="marketplace">ğŸ›’ Marketplace</button> <button class="nav-tab" data-tab="xubor">ğŸ’° Acheter Xubor</button> <button class="nav-tab" data-tab="profile">ğŸ‘¤ Profil</button> <button class="nav-tab" data-tab="friends">ğŸ‘¥ Amis</button>
    </div>
    <div id="homeSection" class="content-section active"><input type="text" class="search-bar" id="gameSearch" placeholder="ğŸ” Rechercher un jeu...">
     <div class="games-grid" id="gamesGrid"></div>
    </div>
    <div id="marketplaceSection" class="content-section"><input type="text" class="search-bar" id="skinSearch" placeholder="ğŸ” Rechercher un skin...">
     <div class="skins-grid" id="skinsGrid"></div>
    </div>
    <div id="xuborSection" class="content-section">
     <h2 style="color: white; text-align: center; margin-bottom: 30px; font-size: 32px; text-shadow: 0 4px 8px rgba(0,0,0,0.3);">ğŸ’° Acheter des Xubor</h2>
     <div class="xubor-shop" id="xuborShop"></div>
     <p style="color: rgba(255,255,255,0.8); text-align: center; margin-top: 30px; font-size: 14px; backdrop-filter: blur(10px); background: rgba(0,0,0,0.2); padding: 15px; border-radius: 12px;">âš ï¸ Les paiements rÃ©els nÃ©cessitent un processeur de paiement externe sÃ©curisÃ© (Stripe, PayPal, etc.)</p>
    </div>
    <div id="profileSection" class="content-section">
     <div class="profile-section">
      <div class="profile-header">
       <div class="profile-avatar-large"><img id="profileAvatar" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='50' fill='%23667eea'/%3E%3Ctext x='50' y='65' font-family='Arial' font-size='40' font-weight='bold' fill='white' text-anchor='middle'%3EğŸ‘¤%3C/text%3E%3C/svg%3E" alt="Avatar">
       </div>
       <div class="profile-username" id="profileUsername">
        Utilisateur
       </div>
       <div class="profile-level" id="profileLevel">
        Niveau 1
       </div>
      </div>
      <div class="profile-stats">
       <div class="stat-card">
        <div class="stat-value" id="statXubor">
         0
        </div>
        <div class="stat-label">
         Xubor
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-value" id="statSkins">
         0
        </div>
        <div class="stat-label">
         Skins possÃ©dÃ©s
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-value" id="statFriends">
         0
        </div>
        <div class="stat-label">
         Amis
        </div>
       </div>
       <div class="stat-card">
        <div class="stat-value" id="statLevel">
         1
        </div>
        <div class="stat-label">
         Niveau
        </div>
       </div>
      </div>
      <h3 style="margin-bottom: 20px; color: #333; font-size: 24px;">ğŸ¨ Mes Skins</h3>
      <div class="skins-grid" id="ownedSkinsGrid"></div>
     </div>
    </div>
    <div id="friendsSection" class="content-section">
     <div class="friends-section">
      <h2 style="margin-bottom: 25px; color: #333; font-size: 28px;">ğŸ‘¥ CommunautÃ© Xolbor</h2><input type="text" class="search-bar" id="friendSearch" placeholder="ğŸ” Rechercher des joueurs...">
      <div class="friends-list" id="friendsList"></div>
     </div>
    </div>
   </div>
  </div><!-- Modal de jeu -->
  <div id="gameModal" class="game-modal">
   <div class="game-container">
    <div class="game-header">
     <h2 id="gameTitle">Jeu</h2><button class="close-game" id="closeGame">Ã—</button>
    </div>
    <canvas id="gameCanvas" class="game-canvas" width="400" height="400"></canvas>
    <div class="game-controls">
     <div class="game-score" id="gameScore">
      Score: 0
     </div><button class="game-btn" id="startGame">Commencer</button> <button class="game-btn" id="pauseGame" style="display: none;">Pause</button> <button class="game-btn" id="restartGame" style="display: none;">Recommencer</button>
    </div>
    <div id="gameInstructions" style="margin-top: 20px; padding: 15px; background: #f0f0f0; border-radius: 12px; font-size: 14px; color: #666;"></div>
   </div>
  </div>
  <script>
        const defaultConfig = {
            app_title: "Xolbor",
            welcome_message: "Bienvenue sur Xolbor"
        };

        let currentUser = null;
        let allUsers = [];
        let allSkins = [];
        let allGames = [];
        let currentGame = null;
        let gameState = {};

        // Initialisation des jeux avec vrais jeux jouables
        const games = [
            { id: 1, name: "Snake 3D", icon: "ğŸ", description: "Le classique Snake avec effets 3D", playable: true },
            { id: 2, name: "Tetris Cube", icon: "ğŸ§Š", description: "Tetris avec effets visuels 3D", playable: true },
            { id: 3, name: "Memory Cards", icon: "ğŸƒ", description: "Jeu de mÃ©moire interactif", playable: true },
            { id: 4, name: "Space Shooter", icon: "ğŸš€", description: "DÃ©truisez les astÃ©roÃ¯des spatiaux", playable: true },
            { id: 5, name: "Puzzle Slider", icon: "ğŸ§©", description: "Puzzle coulissant 3x3", playable: true },
            { id: 6, name: "Color Match", icon: "ğŸ¨", description: "Associez les couleurs rapidement", playable: true },
            { id: 7, name: "Breakout 3D", icon: "ğŸ“", description: "Casse-briques avec effets 3D", playable: true },
            { id: 8, name: "Racing Circuit", icon: "ğŸï¸", description: "Course sur circuit (BientÃ´t)", playable: false },
            { id: 9, name: "RPG Quest", icon: "ğŸ—¡ï¸", description: "Aventure RPG (BientÃ´t)", playable: false },
            { id: 10, name: "City Builder", icon: "ğŸ™ï¸", description: "Construisez votre ville (BientÃ´t)", playable: false }
        ];

        // GÃ©nÃ©ration de skins avec plus de variÃ©tÃ©
        const skinEmojis = ["ğŸ˜€", "ğŸ˜", "ğŸ¤–", "ğŸ‘½", "ğŸ¦¸", "ğŸ§™", "ğŸ¦¹", "ğŸ§›", "ğŸ§œ", "ğŸ§š", "ğŸ¦„", "ğŸ‰", "ğŸ¦", "ğŸ¯", "ğŸ»", "ğŸ¼", "ğŸ¨", "ğŸ¸", "ğŸ¦Š", "ğŸº", "ğŸ¦", "ğŸ±", "ğŸ¶", "ğŸ·", "ğŸ®", "ğŸ”", "ğŸ§", "ğŸ¦†", "ğŸ¦…", "ğŸ¦‰", "ğŸ¦‡", "ğŸ", "ğŸ¦‹", "ğŸŒ", "ğŸ", "ğŸ¦—", "ğŸ•·ï¸", "ğŸ¦‚", "ğŸ¦€", "ğŸ¦", "ğŸ¦", "ğŸ™", "ğŸ¦‘", "ğŸ ", "ğŸŸ", "ğŸ¡", "ğŸ¦ˆ", "ğŸ³", "ğŸ‹", "ğŸ¬", "ğŸ¦­", "ğŸ¦¦", "ğŸ¦¥", "ğŸ¦˜", "ğŸ¦™", "ğŸ¦’", "ğŸ¦", "ğŸ¦›", "ğŸ˜", "ğŸ¦£", "ğŸª", "ğŸ«", "ğŸ¦Œ", "ğŸ", "ğŸ¦“", "ğŸ¦", "ğŸ¦§", "ğŸ’", "ğŸ¦œ", "ğŸ¦š", "ğŸ¦©", "ğŸ¦¢", "ğŸ¦¤", "ğŸ¦†", "ğŸ“", "ğŸ¦ƒ", "ğŸ¦…", "ğŸ¦‰", "ğŸ¦‡", "ğŸº", "ğŸ¦Š", "ğŸ¦", "ğŸ±", "ğŸˆ", "ğŸ¦", "ğŸ¯", "ğŸ…", "ğŸ†", "ğŸ´", "ğŸ", "ğŸ¦„", "ğŸ¦“", "ğŸ¦Œ", "ğŸ¦¬", "ğŸ®", "ğŸ‚", "ğŸƒ", "ğŸ„", "ğŸ·", "ğŸ–", "ğŸ—", "ğŸ½", "ğŸ", "ğŸ‘", "ğŸ", "ğŸª", "ğŸ«", "ğŸ¦™", "ğŸ¦’", "ğŸ˜"];
        
        const skinNames = ["Guerrier", "Mage", "Archer", "Paladin", "Voleur", "Berserker", "Druide", "NÃ©cromancien", "Barde", "Moine", "Ranger", "Sorcier", "Chevalier", "Assassin", "PrÃªtre", "Barbare", "Chaman", "DÃ©moniste", "Chasseur", "Ninja"];
        
        for (let i = 1; i <= 120; i++) {
            const rarity = i <= 20 ? "LÃ©gendaire" : i <= 50 ? "Ã‰pique" : i <= 80 ? "Rare" : "Commun";
            const multiplier = rarity === "LÃ©gendaire" ? 5 : rarity === "Ã‰pique" ? 3 : rarity === "Rare" ? 2 : 1;
            
            allSkins.push({
                id: i,
                name: `${skinNames[i % skinNames.length]} ${rarity}`,
                emoji: skinEmojis[i % skinEmojis.length],
                price: Math.floor((Math.random() * 300 + 100) * multiplier),
                rarity: rarity,
                gradient: `linear-gradient(${Math.random() * 360}deg, hsl(${Math.random() * 360}, 70%, 60%), hsl(${Math.random() * 360}, 70%, 40%))`
            });
        }

        allGames = games;

        // CrÃ©ation des particules d'arriÃ¨re-plan
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Gestion des donnÃ©es avec systÃ¨me en ligne
        const dataHandler = {
            onDataChanged(data) {
                allUsers = data.filter(d => d.type === 'user');
                if (currentUser) {
                    const updatedUser = allUsers.find(u => u.id === currentUser.id);
                    if (updatedUser) {
                        currentUser = updatedUser;
                        updateUI();
                    }
                }
                // Mettre Ã  jour l'affichage des amis avec statut en ligne
                renderFriends();
            }
        };

        // SystÃ¨me de statut en ligne amÃ©liorÃ©
        async function updateOnlineStatus() {
            if (!currentUser) return;
            
            const updatedUser = {
                ...currentUser,
                lastOnline: new Date().toISOString(),
                isOnline: true
            };
            
            await window.dataSdk.update(updatedUser);
        }

        // Mettre Ã  jour le statut toutes les 30 secondes
        setInterval(() => {
            if (currentUser) {
                updateOnlineStatus();
            }
        }, 30000);

        // Marquer comme hors ligne Ã  la fermeture
        window.addEventListener('beforeunload', async () => {
            if (currentUser) {
                const updatedUser = {
                    ...currentUser,
                    isOnline: false,
                    lastOnline: new Date().toISOString()
                };
                await window.dataSdk.update(updatedUser);
            }
        });

        async function initApp() {
            if (allUsers.length >= 999) {
                showError("Limite maximale de 999 utilisateurs atteinte. Impossible de crÃ©er de nouveaux comptes.");
                return;
            }

            const initResult = await window.dataSdk.init(dataHandler);
            if (!initResult.isOk) {
                console.error("Erreur d'initialisation");
                return;
            }
            
            createParticles();
            renderGames();
            renderSkins();
            renderXuborShop();
        }

        // Authentification avec 500 Xubor de dÃ©part CORRIGÃ‰
        document.getElementById('showRegisterBtn').addEventListener('click', () => {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            clearMessages();
        });

        document.getElementById('showLoginBtn').addEventListener('click', () => {
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
            clearMessages();
        });

        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (allUsers.length >= 999) {
                showError("Limite maximale de 999 utilisateurs atteinte. Impossible de crÃ©er de nouveaux comptes.");
                return;
            }

            const username = document.getElementById('registerUsername').value.trim();
            const password = document.getElementById('registerPassword').value;
            const passwordConfirm = document.getElementById('registerPasswordConfirm').value;

            if (password !== passwordConfirm) {
                showError("Les mots de passe ne correspondent pas");
                return;
            }

            const existingUser = allUsers.find(u => u.username.toLowerCase() === username.toLowerCase());
            if (existingUser) {
                showError("Ce nom d'utilisateur existe dÃ©jÃ ");
                return;
            }

            const btn = e.target.querySelector('button[type="submit"]');
            btn.classList.add('loading');
            btn.textContent = 'Inscription...';

            const newUser = {
                id: Date.now().toString(),
                type: 'user',
                username: username,
                password: password,
                xubor: 500, // 500 Xubor de dÃ©part GARANTI
                ownedSkins: JSON.stringify([1]),
                currentSkin: '1',
                friends: JSON.stringify([]),
                gameScores: JSON.stringify({}),
                level: 1,
                experience: 0,
                lastOnline: new Date().toISOString(),
                isOnline: true,
                createdAt: new Date().toISOString()
            };

            const result = await window.dataSdk.create(newUser);
            
            btn.classList.remove('loading');
            btn.textContent = "S'inscrire";

            if (result.isOk) {
                showSuccess("Compte crÃ©Ã© avec succÃ¨s ! Vous avez reÃ§u 500 Xubor de bienvenue ! ğŸ‰");
                setTimeout(() => {
                    document.getElementById('showLoginBtn').click();
                    document.getElementById('loginUsername').value = username;
                }, 2000);
            } else {
                showError("Erreur lors de la crÃ©ation du compte");
            }
        });

        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;

            const user = allUsers.find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = user;
                // Marquer comme en ligne immÃ©diatement
                await updateOnlineStatus();
                
                document.getElementById('authPage').style.display = 'none';
                document.getElementById('mainPage').style.display = 'block';
                updateUI();
                showSuccess(`Bienvenue ${user.username} ! ğŸ®`);
            } else {
                showError("Nom d'utilisateur ou mot de passe incorrect");
            }
        });

        document.getElementById('logoutBtn').addEventListener('click', async () => {
            if (currentUser) {
                // Marquer comme hors ligne avant de se dÃ©connecter
                const updatedUser = {
                    ...currentUser,
                    isOnline: false,
                    lastOnline: new Date().toISOString()
                };
                await window.dataSdk.update(updatedUser);
            }
            
            currentUser = null;
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('authPage').style.display = 'flex';
            document.getElementById('loginForm').reset();
            clearMessages();
        });

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        function showSuccess(message) {
            const successDiv = document.getElementById('successMessage');
            successDiv.textContent = message;
            successDiv.style.display = 'block';
            setTimeout(() => {
                successDiv.style.display = 'none';
            }, 5000);
        }

        function clearMessages() {
            document.getElementById('errorMessage').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
        }

        // Navigation amÃ©liorÃ©e
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                document.getElementById(tab.dataset.tab + 'Section').classList.add('active');
            });
        });

        document.getElementById('profileBtn').addEventListener('click', () => {
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.querySelector('[data-tab="profile"]').classList.add('active');
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.getElementById('profileSection').classList.add('active');
        });

        // Rendu des jeux amÃ©liorÃ©
        function renderGames() {
            const grid = document.getElementById('gamesGrid');
            grid.innerHTML = allGames.map(game => `
                <div class="game-card" onclick="${game.playable ? `playGame(${game.id})` : 'showComingSoon()'}">
                    <div class="game-icon">${game.icon}</div>
                    <h3>${game.name}</h3>
                    <p>${game.description}</p>
                    ${game.playable ? '<div class="play-badge">â–¶ï¸ JOUER</div>' : '<div class="coming-soon-badge">ğŸ”œ BIENTÃ”T</div>'}
                </div>
            `).join('');
        }

        function showComingSoon() {
            showSuccess("Ce jeu arrive bientÃ´t ! Restez connectÃ© ! ğŸš€");
        }

        // SystÃ¨me de jeux (code des jeux identique...)
        function playGame(gameId) {
            const game = allGames.find(g => g.id === gameId);
            if (!game || !game.playable) return;

            currentGame = game;
            document.getElementById('gameTitle').textContent = game.name;
            document.getElementById('gameModal').classList.add('active');
            
            // RÃ©initialiser l'Ã©tat du jeu
            gameState = { score: 0, running: false, paused: false };
            document.getElementById('gameScore').textContent = 'Score: 0';
            document.getElementById('startGame').style.display = 'inline-block';
            document.getElementById('pauseGame').style.display = 'none';
            document.getElementById('restartGame').style.display = 'none';

            setupGame(gameId);
        }

        function setupGame(gameId) {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');
            const instructions = document.getElementById('gameInstructions');

            // Nettoyer le canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            switch(gameId) {
                case 1: // Snake 3D
                    instructions.innerHTML = "ğŸ <strong>Snake 3D</strong><br>Utilisez les flÃ¨ches pour diriger le serpent. Mangez les pommes pour grandir !";
                    setupSnakeGame(canvas, ctx);
                    break;
                case 2: // Tetris Cube
                    instructions.innerHTML = "ğŸ§Š <strong>Tetris Cube</strong><br>FlÃ¨ches â† â†’ pour bouger, â†“ pour accÃ©lÃ©rer, â†‘ pour tourner";
                    setupTetrisGame(canvas, ctx);
                    break;
                case 3: // Memory Cards
                    instructions.innerHTML = "ğŸƒ <strong>Memory Cards</strong><br>Cliquez sur les cartes pour les retourner et trouvez les paires !";
                    setupMemoryGame(canvas, ctx);
                    break;
                case 4: // Space Shooter
                    instructions.innerHTML = "ğŸš€ <strong>Space Shooter</strong><br>FlÃ¨ches pour bouger, ESPACE pour tirer. DÃ©truisez les astÃ©roÃ¯des !";
                    setupSpaceShooterGame(canvas, ctx);
                    break;
                case 5: // Puzzle Slider
                    instructions.innerHTML = "ğŸ§© <strong>Puzzle Slider</strong><br>Cliquez sur les piÃ¨ces adjacentes Ã  l'espace vide pour les dÃ©placer";
                    setupPuzzleSliderGame(canvas, ctx);
                    break;
                case 6: // Color Match
                    instructions.innerHTML = "ğŸ¨ <strong>Color Match</strong><br>Cliquez sur la couleur qui correspond au texte affichÃ© !";
                    setupColorMatchGame(canvas, ctx);
                    break;
                case 7: // Breakout 3D
                    instructions.innerHTML = "ğŸ“ <strong>Breakout 3D</strong><br>Bougez la souris pour contrÃ´ler la raquette. Cassez tous les blocs !";
                    setupBreakoutGame(canvas, ctx);
                    break;
            }
        }

        // [Tous les jeux restent identiques - Snake, Tetris, Memory, etc...]
        // Jeu Snake 3D
        function setupSnakeGame(canvas, ctx) {
            gameState.snake = [{x: 200, y: 200}];
            gameState.direction = {x: 0, y: 0};
            gameState.food = {x: 100, y: 100};
            gameState.gridSize = 20;

            function drawSnake() {
                ctx.fillStyle = '#667eea';
                gameState.snake.forEach((segment, index) => {
                    ctx.fillRect(segment.x, segment.y, gameState.gridSize, gameState.gridSize);
                    // Effet 3D
                    ctx.fillStyle = index === 0 ? '#764ba2' : '#8b7ec8';
                    ctx.fillRect(segment.x + 2, segment.y + 2, gameState.gridSize - 4, gameState.gridSize - 4);
                });
            }

            function drawFood() {
                ctx.fillStyle = '#ff6b6b';
                ctx.fillRect(gameState.food.x, gameState.food.y, gameState.gridSize, gameState.gridSize);
                ctx.fillStyle = '#ff5252';
                ctx.fillRect(gameState.food.x + 4, gameState.food.y + 4, gameState.gridSize - 8, gameState.gridSize - 8);
            }

            function moveSnake() {
                if (!gameState.running || gameState.paused) return;

                const head = {
                    x: gameState.snake[0].x + gameState.direction.x,
                    y: gameState.snake[0].y + gameState.direction.y
                };

                // VÃ©rifier les collisions avec les murs
                if (head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height) {
                    gameOver();
                    return;
                }

                // VÃ©rifier les collisions avec le corps
                if (gameState.snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                    gameOver();
                    return;
                }

                gameState.snake.unshift(head);

                // VÃ©rifier si la nourriture est mangÃ©e
                if (head.x === gameState.food.x && head.y === gameState.food.y) {
                    gameState.score += 10;
                    document.getElementById('gameScore').textContent = `Score: ${gameState.score}`;
                    generateFood();
                } else {
                    gameState.snake.pop();
                }
            }

            function generateFood() {
                gameState.food = {
                    x: Math.floor(Math.random() * (canvas.width / gameState.gridSize)) * gameState.gridSize,
                    y: Math.floor(Math.random() * (canvas.height / gameState.gridSize)) * gameState.gridSize
                };
            }

            function gameLoop() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawSnake();
                drawFood();
                moveSnake();
                if (gameState.running) {
                    setTimeout(gameLoop, 150);
                }
            }

            function gameOver() {
                gameState.running = false;
                ctx.fillStyle = 'rgba(0,0,0,0.7)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = 'white';
                ctx.font = '24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Game Over!', canvas.width/2, canvas.height/2);
                ctx.fillText(`Score: ${gameState.score}`, canvas.width/2, canvas.height/2 + 30);
                
                document.getElementById('restartGame').style.display = 'inline-block';
                saveGameScore(gameState.score);
            }

            // ContrÃ´les
            document.addEventListener('keydown', (e) => {
                if (!gameState.running) return;
                
                switch(e.key) {
                    case 'ArrowUp':
                        if (gameState.direction.y === 0) gameState.direction = {x: 0, y: -gameState.gridSize};
                        break;
                    case 'ArrowDown':
                        if (gameState.direction.y === 0) gameState.direction = {x: 0, y: gameState.gridSize};
                        break;
                    case 'ArrowLeft':
                        if (gameState.direction.x === 0) gameState.direction = {x: -gameState.gridSize, y: 0};
                        break;
                    case 'ArrowRight':
                        if (gameState.direction.x === 0) gameState.direction = {x: gameState.gridSize, y: 0};
                        break;
                }
            });

            gameState.gameLoop = gameLoop;
        }

        // [Autres jeux identiques...]

        // ContrÃ´les de jeu
        document.getElementById('startGame').addEventListener('click', () => {
            gameState.running = true;
            gameState.paused = false;
            gameState.score = 0;
            document.getElementById('gameScore').textContent = 'Score: 0';
            document.getElementById('startGame').style.display = 'none';
            document.getElementById('pauseGame').style.display = 'inline-block';
            document.getElementById('restartGame').style.display = 'inline-block';

            if (gameState.gameLoop) {
                gameState.gameLoop();
            }
        });

        document.getElementById('pauseGame').addEventListener('click', () => {
            gameState.paused = !gameState.paused;
            document.getElementById('pauseGame').textContent = gameState.paused ? 'Reprendre' : 'Pause';
        });

        document.getElementById('restartGame').addEventListener('click', () => {
            gameState.running = false;
            setTimeout(() => {
                setupGame(currentGame.id);
                document.getElementById('startGame').click();
            }, 100);
        });

        document.getElementById('closeGame').addEventListener('click', () => {
            gameState.running = false;
            document.getElementById('gameModal').classList.remove('active');
        });

        // Sauvegarder le score avec XP
        async function saveGameScore(score) {
            if (!currentUser || !currentGame) return;

            const gameScores = JSON.parse(currentUser.gameScores);
            const gameKey = `game_${currentGame.id}`;
            
            if (!gameScores[gameKey] || score > gameScores[gameKey]) {
                gameScores[gameKey] = score;
                
                const updatedUser = {
                    ...currentUser,
                    gameScores: JSON.stringify(gameScores),
                    experience: currentUser.experience + Math.floor(score / 10),
                    level: Math.floor((currentUser.experience + Math.floor(score / 10)) / 100) + 1,
                    xubor: currentUser.xubor + Math.floor(score / 20) // Bonus Xubor pour les scores
                };

                await window.dataSdk.update(updatedUser);
                showSuccess(`Nouveau record ! +${Math.floor(score / 10)} XP, +${Math.floor(score / 20)} Xubor`);
            }
        }

        // Recherche de jeux
        document.getElementById('gameSearch').addEventListener('input', (e) => {
            const search = e.target.value.toLowerCase();
            const filtered = allGames.filter(g => g.name.toLowerCase().includes(search) || g.description.toLowerCase().includes(search));
            const grid = document.getElementById('gamesGrid');
            grid.innerHTML = filtered.map(game => `
                <div class="game-card" onclick="${game.playable ? `playGame(${game.id})` : 'showComingSoon()'}">
                    <div class="game-icon">${game.icon}</div>
                    <h3>${game.name}</h3>
                    <p>${game.description}</p>
                    ${game.playable ? '<div class="play-badge">â–¶ï¸ JOUER</div>' : '<div class="coming-soon-badge">ğŸ”œ BIENTÃ”T</div>'}
                </div>
            `).join('');
        });

        // Rendu des skins amÃ©liorÃ©
        function renderSkins() {
            const grid = document.getElementById('skinsGrid');
            grid.innerHTML = allSkins.map(skin => {
                const owned = currentUser && JSON.parse(currentUser.ownedSkins).includes(skin.id);
                const rarityColor = skin.rarity === 'LÃ©gendaire' ? '#ffd700' : 
                                  skin.rarity === 'Ã‰pique' ? '#a855f7' : 
                                  skin.rarity === 'Rare' ? '#3b82f6' : '#6b7280';
                
                return `
                    <div class="skin-card" style="border: 2px solid ${rarityColor}">
                        <div class="skin-preview" style="background: ${skin.gradient}">
                            <span style="font-size: 60px;">${skin.emoji}</span>
                        </div>
                        <div class="skin-name">${skin.name}</div>
                        <div style="color: ${rarityColor}; font-size: 12px; font-weight: 700; margin-bottom: 8px;">${skin.rarity}</div>
                        <div class="skin-price">${skin.price} Xubor</div>
                        <button class="btn-buy" onclick="buySkin(${skin.id})" ${owned ? 'disabled' : ''}>
                            ${owned ? 'âœ“ PossÃ©dÃ©' : 'Acheter'}
                        </button>
                    </div>
                `;
            }).join('');
        }

        // Recherche de skins
        document.getElementById('skinSearch').addEventListener('input', (e) => {
            const search = e.target.value.toLowerCase();
            const filtered = allSkins.filter(s => s.name.toLowerCase().includes(search) || s.rarity.toLowerCase().includes(search));
            const grid = document.getElementById('skinsGrid');
            grid.innerHTML = filtered.map(skin => {
                const owned = currentUser && JSON.parse(currentUser.ownedSkins).includes(skin.id);
                const rarityColor = skin.rarity === 'LÃ©gendaire' ? '#ffd700' : 
                                  skin.rarity === 'Ã‰pique' ? '#a855f7' : 
                                  skin.rarity === 'Rare' ? '#3b82f6' : '#6b7280';
                
                return `
                    <div class="skin-card" style="border: 2px solid ${rarityColor}">
                        <div class="skin-preview" style="background: ${skin.gradient}">
                            <span style="font-size: 60px;">${skin.emoji}</span>
                        </div>
                        <div class="skin-name">${skin.name}</div>
                        <div style="color: ${rarityColor}; font-size: 12px; font-weight: 700; margin-bottom: 8px;">${skin.rarity}</div>
                        <div class="skin-price">${skin.price} Xubor</div>
                        <button class="btn-buy" onclick="buySkin(${skin.id})" ${owned ? 'disabled' : ''}>
                            ${owned ? 'âœ“ PossÃ©dÃ©' : 'Acheter'}
                        </button>
                    </div>
                `;
            }).join('');
        });

        // Achat de skin avec confirmation
        async function buySkin(skinId) {
            if (!currentUser) return;
            
            const skin = allSkins.find(s => s.id === skinId);
            const ownedSkins = JSON.parse(currentUser.ownedSkins);
            
            if (ownedSkins.includes(skinId)) {
                return;
            }
            
            if (currentUser.xubor < skin.price) {
                showError(`Vous n'avez pas assez de Xubor ! Il vous faut ${skin.price - currentUser.xubor} Xubor de plus.`);
                return;
            }

            // Confirmation d'achat inline
            const confirmDiv = document.createElement('div');
            confirmDiv.style.cssText = `
                position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                background: white; padding: 30px; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                z-index: 2000; text-align: center; max-width: 400px;
            `;
            confirmDiv.innerHTML = `
                <h3 style="margin: 0 0 15px 0; color: #333;">Confirmer l'achat</h3>
                <div style="font-size: 48px; margin: 15px 0;">${skin.emoji}</div>
                <p style="margin: 15px 0; color: #666;">${skin.name}<br><strong>${skin.price} Xubor</strong></p>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button onclick="this.parentElement.parentElement.remove()" style="flex: 1; padding: 12px; background: #f5f5f5; border: none; border-radius: 8px; cursor: pointer;">Annuler</button>
                    <button onclick="confirmPurchase(${skinId}); this.parentElement.parentElement.remove();" style="flex: 1; padding: 12px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer;">Acheter</button>
                </div>
            `;
            document.body.appendChild(confirmDiv);
        }

        async function confirmPurchase(skinId) {
            const skin = allSkins.find(s => s.id === skinId);
            const ownedSkins = JSON.parse(currentUser.ownedSkins);

            const updatedUser = {
                ...currentUser,
                xubor: currentUser.xubor - skin.price,
                ownedSkins: JSON.stringify([...ownedSkins, skinId]),
                currentSkin: skinId.toString(),
                experience: currentUser.experience + 25,
                level: Math.floor((currentUser.experience + 25) / 100) + 1
            };

            const result = await window.dataSdk.update(updatedUser);
            if (result.isOk) {
                showSuccess(`Skin ${skin.name} achetÃ© et Ã©quipÃ© ! +25 XP ğŸ¨`);
            } else {
                showError("Erreur lors de l'achat");
            }
        }

        // Boutique Xubor amÃ©liorÃ©e
        function renderXuborShop() {
            const shop = document.getElementById('xuborShop');
            const packs = [
                { xubor: 500, price: 5, featured: false, bonus: '' },
                { xubor: 1200, price: 10, featured: false, bonus: '+200 bonus!' },
                { xubor: 2800, price: 20, featured: true, bonus: '+800 bonus!' },
                { xubor: 6000, price: 40, featured: true, bonus: '+2000 bonus!' }
            ];

            shop.innerHTML = packs.map(pack => `
                <div class="xubor-pack ${pack.featured ? 'featured' : ''}">
                    <div class="xubor-amount">${pack.xubor}</div>
                    <div style="color: #666; margin-bottom: 10px; font-weight: 600;">Xubor</div>
                    ${pack.bonus ? `<div style="color: #4ade80; font-size: 14px; font-weight: 700; margin-bottom: 10px;">${pack.bonus}</div>` : ''}
                    <div class="xubor-price">${pack.price}â‚¬</div>
                    <button class="btn-purchase" onclick="purchaseXubor(${pack.xubor})">
                        Acheter
                    </button>
                    <div class="demo-badge">DEMO</div>
                </div>
            `).join('');
        }

        async function purchaseXubor(amount) {
            if (!currentUser) return;

            showSuccess(`Achat de ${amount} Xubor effectuÃ© ! (Mode dÃ©mo) ğŸ’°`);
            
            const updatedUser = {
                ...currentUser,
                xubor: currentUser.xubor + amount
            };

            await window.dataSdk.update(updatedUser);
        }

        // Mise Ã  jour de l'interface amÃ©liorÃ©e
        function updateUI() {
            if (!currentUser) return;

            document.getElementById('xuborAmount').textContent = currentUser.xubor.toLocaleString();
            document.getElementById('profileUsername').textContent = currentUser.username;
            document.getElementById('profileLevel').textContent = `Niveau ${currentUser.level}`;
            document.getElementById('statXubor').textContent = currentUser.xubor.toLocaleString();
            document.getElementById('statLevel').textContent = currentUser.level;
            
            const ownedSkins = JSON.parse(currentUser.ownedSkins);
            document.getElementById('statSkins').textContent = ownedSkins.length;
            
            const friends = JSON.parse(currentUser.friends);
            document.getElementById('statFriends').textContent = friends.length;

            const currentSkin = allSkins.find(s => s.id === parseInt(currentUser.currentSkin));
            if (currentSkin) {
                const avatarSvg = `data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cdefs%3E%3ClinearGradient id='grad${currentSkin.id}' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%23667eea;stop-opacity:1' /%3E%3Cstop offset='100%25' style='stop-color:%23764ba2;stop-opacity:1' /%3E%3C/linearGradient%3E%3C/defs%3E%3Ccircle cx='50' cy='50' r='50' fill='url(%23grad${currentSkin.id})'/%3E%3Ctext x='50' y='65' font-family='Arial' font-size='40' font-weight='bold' fill='white' text-anchor='middle'%3E${currentSkin.emoji}%3C/text%3E%3C/svg%3E`;
                document.getElementById('headerAvatar').src = avatarSvg;
                document.getElementById('profileAvatar').src = avatarSvg;
            }

            renderOwnedSkins();
            renderSkins();
            renderFriends();
        }

        function renderOwnedSkins() {
            const grid = document.getElementById('ownedSkinsGrid');
            const ownedSkins = JSON.parse(currentUser.ownedSkins);
            const skins = allSkins.filter(s => ownedSkins.includes(s.id));
            
            grid.innerHTML = skins.map(skin => {
                const rarityColor = skin.rarity === 'LÃ©gendaire' ? '#ffd700' : 
                                  skin.rarity === 'Ã‰pique' ? '#a855f7' : 
                                  skin.rarity === 'Rare' ? '#3b82f6' : '#6b7280';
                
                return `
                    <div class="skin-card" style="border: 2px solid ${rarityColor}">
                        <div class="skin-preview" style="background: ${skin.gradient}">
                            <span style="font-size: 60px;">${skin.emoji}</span>
                        </div>
                        <div class="skin-name">${skin.name}</div>
                        <div style="color: ${rarityColor}; font-size: 12px; font-weight: 700; margin-bottom: 8px;">${skin.rarity}</div>
                        <button class="btn-buy" onclick="equipSkin(${skin.id})" ${currentUser.currentSkin === skin.id.toString() ? 'disabled' : ''}>
                            ${currentUser.currentSkin === skin.id.toString() ? 'âœ“ Ã‰quipÃ©' : 'Ã‰quiper'}
                        </button>
                    </div>
                `;
            }).join('');
        }

        async function equipSkin(skinId) {
            if (!currentUser) return;

            const updatedUser = {
                ...currentUser,
                currentSkin: skinId.toString()
            };

            const result = await window.dataSdk.update(updatedUser);
            if (result.isOk) {
                showSuccess("Skin Ã©quipÃ© avec succÃ¨s ! âœ¨");
            }
        }

        // SystÃ¨me d'amis avec statut en ligne RÃ‰EL
        function renderFriends() {
            const friendsList = document.getElementById('friendsList');
            const otherUsers = allUsers.filter(u => u.id !== currentUser.id);
            
            if (otherUsers.length === 0) {
                friendsList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666; grid-column: 1 / -1;">
                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸ‘¥</div>
                        <h3>Aucun autre joueur pour le moment</h3>
                        <p>Invitez vos amis Ã  rejoindre Xolbor !</p>
                    </div>
                `;
                return;
            }
            
            friendsList.innerHTML = otherUsers.map(user => {
                const userSkin = allSkins.find(s => s.id === parseInt(user.currentSkin)) || allSkins[0];
                const isOnline = user.isOnline && (new Date() - new Date(user.lastOnline)) < 60000; // En ligne si activitÃ© < 1 min
                const lastSeen = isOnline ? 'En ligne' : `Vu ${getTimeAgo(user.lastOnline)}`;
                
                return `
                    <div class="friend-card">
                        <div class="friend-avatar" style="background: ${userSkin.gradient}">
                            ${userSkin.emoji}
                        </div>
                        <div class="friend-info">
                            <div class="friend-name">${user.username}</div>
                            <div class="friend-status">Niveau ${user.level} â€¢ ${user.xubor} Xubor</div>
                            <div style="font-size: 12px; color: ${isOnline ? '#4ade80' : '#9ca3af'}; margin-top: 4px;">
                                ${lastSeen}
                            </div>
                        </div>
                        <div class="friend-level">Niv. ${user.level}</div>
                        <div class="${isOnline ? 'online-indicator' : 'offline-indicator'}"></div>
                    </div>
                `;
            }).join('');
        }

        function getTimeAgo(dateString) {
            const now = new Date();
            const past = new Date(dateString);
            const diffMs = now - past;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);

            if (diffMins < 1) return 'Ã  l\'instant';
            if (diffMins < 60) return `il y a ${diffMins}min`;
            if (diffHours < 24) return `il y a ${diffHours}h`;
            return `il y a ${diffDays}j`;
        }

        // Recherche d'amis amÃ©liorÃ©e
        document.getElementById('friendSearch').addEventListener('input', (e) => {
            const search = e.target.value.toLowerCase();
            const otherUsers = allUsers.filter(u => 
                u.id !== currentUser.id && 
                u.username.toLowerCase().includes(search)
            );
            
            const friendsList = document.getElementById('friendsList');
            
            if (otherUsers.length === 0) {
                friendsList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666; grid-column: 1 / -1;">
                        <div style="font-size: 48px; margin-bottom: 15px;">ğŸ”</div>
                        <h3>Aucun joueur trouvÃ©</h3>
                        <p>Essayez un autre nom d'utilisateur</p>
                    </div>
                `;
                return;
            }
            
            friendsList.innerHTML = otherUsers.map(user => {
                const userSkin = allSkins.find(s => s.id === parseInt(user.currentSkin)) || allSkins[0];
                const isOnline = user.isOnline && (new Date() - new Date(user.lastOnline)) < 60000;
                const lastSeen = isOnline ? 'En ligne' : `Vu ${getTimeAgo(user.lastOnline)}`;
                
                return `
                    <div class="friend-card">
                        <div class="friend-avatar" style="background: ${userSkin.gradient}">
                            ${userSkin.emoji}
                        </div>
                        <div class="friend-info">
                            <div class="friend-name">${user.username}</div>
                            <div class="friend-status">Niveau ${user.level} â€¢ ${user.xubor} Xubor</div>
                            <div style="font-size: 12px; color: ${isOnline ? '#4ade80' : '#9ca3af'}; margin-top: 4px;">
                                ${lastSeen}
                            </div>
                        </div>
                        <div class="friend-level">Niv. ${user.level}</div>
                        <div class="${isOnline ? 'online-indicator' : 'offline-indicator'}"></div>
                    </div>
                `;
            }).join('');
        });

        // Element SDK
        async function onConfigChange(config) {
            document.getElementById('appTitle').textContent = config.app_title || defaultConfig.app_title;
            document.getElementById('welcomeMessage').textContent = config.welcome_message || defaultConfig.welcome_message;
        }

        const capabilities = {
            recolorables: [],
            borderables: [],
            fontEditable: undefined,
            fontSizeable: undefined
        };

        function mapToEditPanelValues(config) {
            return new Map([
                ["app_title", config.app_title || defaultConfig.app_title],
                ["welcome_message", config.welcome_message || defaultConfig.welcome_message]
            ]);
        }

        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities: () => capabilities,
                mapToEditPanelValues
            });
        }

        initApp();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99a53af897972c78',t:'MTc2MjQzODgxMy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
